CREATE TABLE trigger_log
(
    log_id NUMBER PRIMARY KEY,
    user_name VARCHAR2(50),
    date_oper DATE,
    INN VARCHAR2(256)
);

CREATE SEQUENCE trigger_log_seq
START WITH 1
INCREMENT BY 1
NOCACHE;

CREATE OR REPLACE TRIGGER check_inn_trg
BEFORE INSERT ON sh.uch_vse FOR EACH ROW
DECLARE
    PRAGMA AUTONOMOUS_TRANSACTION;
BEGIN
    IF LENGTHB(:new.inn) > 255 THEN
        RAISE_APPLICATION_ERROR(-20202,'Неверная структура ИНН. Слишком велико (фактическое: ' || TO_CHAR(LENGTHB(:new.inn)) ||', максимальное: 255)');
    END IF;
    INSERT INTO trigger_log VALUES(trigger_log_seq.nextval,USER,SYSDATE,:new.inn);
    COMMIT;
END check_inn_trg;

--256 байта вместо 255 для срабатывания триггера
INSERT INTO SH.UCH_VSE (INN) VALUES 
('1212313213503680123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789Ы01A2345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234560');

--Хорошая длина 255 байтов
INSERT INTO SH.UCH_VSE (INN) VALUES 
('121231321350680123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789Ы01A2345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234560');

SELECT * FROM trigger_log;

DROP TABLE trigger_log;
DROP TRIGGER check_inn_trg;
DROP SEQUENCE trigger_log_seq;
